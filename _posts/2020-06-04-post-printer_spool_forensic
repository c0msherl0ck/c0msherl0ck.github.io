---
title: "[프린터 포렌식] 스풀(Spool) 파일 분석"
categories:
  - Embedded Forensic
tags:
  - SHD
  - SPL
comments: true
---

프린터 포렌식의 경우에는 크게 두 가지로 분류할 수 있다. 하나는 프린트 명령을 내린 PC를 분석하는 것이고, 
다른 하나는 프린트를 진행한 복합기 및 프린터기를 직접 분석하는 것이다. 이번 글에서는 프린트 명령을 내린 PC 를 분석하는 방법에 대해 소개한다.

> 1. 프린트 흔적 (Print Artifacts)
> 2. 스풀 파일 분석(Spool)
> 3. 참고

# 1. 프린트 흔적 (Print Artifacts)

PC에서 프린트를 진행할 경우, PC 내 임시파일 형태로 프린트와 관련된 데이터를 저장하고 이를 프린터기에 전송한다. 
데이터는 `.SHD`, `.SPL` 형태로 저장되며 이들 파일을 `스풀 파일`(spool)이라고 부르며, `스풀러 작업`(spooler)이란 이러한 파일을 만드는 작업을 뜻한다.

각각의 파일에 저장되는 정보는 프린트 작업 방식 설정(Raw vs EMF)에 따라 차이가 있으며 다음과 같다.

<div class="notice">
For each print job there are two spool files generated by the Windows® NT/2000 spooler. One file with the .SHD extension for job settings, and one with the .SPL extension for the drawing commands.
</div>

|파일 확장자|정보 종류|Raw|EMF|
|---|---|---|---|
|SHD|job settings|프린트 작업 정보|프린트 작업 정보|
|SPL|drawing coommands|인쇄물 원본 데이터|파일명 등 작업 정보 + 인쇄물을 EMF로 변환한 데이터|

프린트 작업 방식 설정(Raw vs EMF)은 `인쇄기본설정`에서 다음과 같이 변경할 수 있다.

<center><p><img src="/assets/2020-06-04-post-printer_spool_forensic/인쇄기본설정.jpg"><br><em>인쇄기본설정</em></p></center>

<center><p><img src="/assets/2020-06-04-post-printer_spool_forensic/상세설정.jpg"><br><em>상세설정</em></p></center>

# 2. 스풀 파일 분석(SHD, SPL)

스풀파일은 인쇄가 종료되면 자동으로 삭제되기 때문에 FTK Imager를 통해 Physical Drive를 마운트하여 삭제된 파일을 확인 및 추출하였다. 
필자의 경우 인쇄 종료 후 곧바로 확인을 하였기 때문에 스풀파일이 복구 가능하였으나, 
C 볼룸에 위치하고 있고 SSD를 사용하는 PC에서 해당 데이터를 복구하는 것은 가능성이 높지 않다.

## 2.1 Raw 방식

- SHD : HxD 에디터를 통해 내용을 확인하면 프린트 작업과 관련된 정보를 확인할 수 있다.
- SPL : **원본 파일**과 같으므로 별도의 도구 없이 열람 및 확인이 가능하다.

<center><p><img src="/assets/2020-06-04-post-printer_spool_forensic/raw_shd.jpg"><br><em>Raw SHD</em></p></center>

<center><p><img src="/assets/2020-06-04-post-printer_spool_forensic/raw_spl.jpg"><br><em>Raw SPL</em></p></center>

## 2.2 EMF 방식

- SHD : HxD 에디터를 통해 내용을 확인하면 프린트 작업과 관련된 정보를 확인할 수 있다.
- SPL : **스풀 헤더(파일명 등 작업정보)를 삭제**하고 EMF 데이터만 남은 상태의 파일의 확장자를 .emf 로 변경후 확인하였다.

<center><p><img src="/assets/2020-06-04-post-printer_spool_forensic/emf_shd.jpg"><br><em>EMF SHD</em></p></center>

<center><p><img src="/assets/2020-06-04-post-printer_spool_forensic/emf_spl.jpg"><br><em>EMF SPL</em></p></center>

# 3. 참고

<http://forensic-proof.com/archives/2922>

<http://www.undocprint.org/formats/winspool/spl>
