---
title: "[프린터 포렌식] 스풀(Spool) 파일 분석"
categories:
  - IoT
tags:
  - SHD
  - SPL
comments: true
---

프린터 포렌식의 경우에는 크게 두 가지로 분류할 수 있다. 하나는 프린트 명령을 내린 PC를 분석하는 것이고, 
다른 하나는 프린트를 진행한 복합기 및 프린터기를 직접 분석하는 것이다. 이번 글에서는 프린트 명령을 내린 PC 를 분석하는 방법에 대해 소개한다.

# 1. 프린트 흔적 (Print Artifacts)

PC에서 프린트를 진행할 경우, PC 내 임시파일 형태로 프린트와 관련된 데이터를 저장하고 이를 프린터기에 전송한다. 
데이터는 `.SHD`, `.SPL` 형태로 저장되며 이들 파일을 `스풀 파일`(spool)이라고 부르며, `스풀러 작업`(spooler)이란 이러한 파일을 만드는 작업을 뜻한다.

각각의 파일에 저장되는 정보는 프린트 작업 방식 설정(Raw vs EMF)에 따라 차이가 있으며 다음과 같다.

<div class="notice">
For each print job there are two spool files generated by the Windows® NT/2000 spooler. One file with the .SHD extension for job settings, and one with the .SPL extension for the drawing commands.
</div>

|파일 확장자|정보 종류|Raw|EMF|
|---|---|---|---|
|SHD|job settings|프린트 작업 정보|프린트 작업 정보|
|SPL|drawing coommands|원본 데이터|파일명등 작업 정보 + 인쇄물을 EMF로 변환한 데이터|

프린트 작업 방식 설정(Raw vs EMF)은 `인쇄기본설정`에서 다음과 같이 변경할 수 있다.

<center><p><img src="/assets/2020-06-04-post-printer_spool_forensic/인쇄기본설정.jpg"><br><em>인쇄기본설정</em></p></center>

<center><p><img src="/assets/2020-06-04-post-printer_spool_forensic/상세설정.jpg"><br><em>상세설정</em></p></center>

# 2. 스풀 파일 분석(SHD, SPL)

## 2.1 Raw 방식

- SHD : HxD 에디터를 통해 내용을 확인하면 프린트 작업과 관련된 정보를 확인할 수 있다.
- SPL : 원본 파일과 같으므로 별도의 도구 없이 열람 및 확인이 가능하다.

## 2.2 EMF 방식



# 3. 참고

<http://forensic-proof.com/archives/2922>

<http://www.undocprint.org/formats/winspool/spl>



- aa
  - bb
    - cc
- dd


// code page
```
aaaaaaaaaaaaaaaaa
```

// 글자 배경
`bbbbb`

//표
|파일명|역할|
|---|---|
|||
|||
|||

// 이미지
<center><p><img src="/assets/폴더명/파일명.jpg"></p></center>
<center><p><img src="/assets/폴더명/파일명.jpg" width="100%"><br><em>주석</em></p></center>
![]({{ site.url }}{{ site.baseurl }}/assets/images/bio-photo-keyboard.jpg)

// 링크 삽입
<{{ site.url }}{{ site.baseurl }}/blog/start-blog/>
[](https://)
[인라인 링크](https://)

